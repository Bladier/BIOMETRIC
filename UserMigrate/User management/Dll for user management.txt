Expiry_List
CREATE VIEW EXPIRY_LIST(
  PAWNID,PAWNTICKET,CLIENTID,LOANDATE,MATUDATE,EXPIRYDATE, AUCTIONDATE,ITEMTYPE,
  CATID,DESCRIPTION,KARAT,GRAMS,APPRAISAL,PRINCIPAL,INTEREST, NETAMOUNT,EVAT,APPRAISERID,
  OLDTICKET,ORNUM,ORDATE,LESSPRINCIPAL,DAYSOVERDUE,DELAYINT,PENALTY,SERVICECHARGE,RENEWDUE,REDEEMDUE,
  STATUS,PULLOUT,SYSTEMINFO,ENCODERID,ADVINT,EARLYREDEEM,INT_CHECKSUM,RENEWALCNT,
  CATEGORY,CLIENTID1,FIRSTNAME,MIDDLENAME,LASTNAME,SUFFIX,ADDR_STREET,ADDR_BRGY,ADDR_CITY,
  ADDR_PROVINCE,ADDR_ZIP,SEX,BIRTHDAY,PHONE1,PHONE2,PHONE3,PHONE_OTHERS,USERNAME)
AS
SELECT P.*, CL.CATEGORY, C.*, U.USERNAME FROM tblPawn P
INNER JOIN tblClient C on P.clientid = C.clientid
INNER JOIN TBL_USER_DEFAULT U on U.USERID = P.ENCODERID
INNER JOIN tblClass CL ON CL.CLASSID = P.CATID
WHERE
 (P.Status = 'L' or P.Status = 'R') AND 
 (CHAR_LENGTH(C.Phone1) = 11 OR CHAR_LENGTH(C.Phone2) = 11);


Loan_Register
CREATE VIEW LOAN_REGISTER(
  PAWNTICKET,PAWNER,ITEMTYPE,LOANDATE,MATUDATE,EXPIRYDATE,APPRAISAL,DESCRIPTION,PRINCIPAL,
  INTEREST,ADVINT,SERVICECHARGE,NETAMOUNT,RENEWDUE,REDEEMDUE, ORDATE,USERNAME,STATUS)
AS
SELECT P.PawnTicket,
       C.FIRSTNAME || ' ' || C.LASTNAME AS PAWNER,P.ITEMTYPE,
       P.LOANDATE,P.MATUDATE,P.EXPIRYDATE,P.APPRAISAL,P.DESCRIPTION,P.PRINCIPAL,
       P.INTEREST,P.ADVINT,P.SERVICECHARGE, P.NETAMOUNT,P.RENEWDUE, P.REDEEMDUE,
       P.ORDATE,U.USERNAME,P.STATUS
FROM tblPAWN P
     INNER JOIN tblClient C on C.ClientID = P.ClientID
     INNER JOIN TBL_USER_DEFAULT U ON U.UserID = P.EncoderID;




Pawning
CREATE VIEW PAWNING(
  PAWNTICKET,LOANDATE,MATUDATE,EXPIRYDATE,AUCTIONDATE,CLIENT,FULLADDRESS,
  DESCRIPTION,ORNUM,ORDATE,OLDTICKET,NETAMOUNT,RENEWDUE,REDEEMDUE,APPRAISAL,
  PRINCIPAL,INTEREST,ADVINT,SERVICECHARGE,PENALTY,ITEMTYPE,CATEGORY,GRAMS,
 KARAT,STATUS,PULLOUT,APPRAISER)
AS
SELECT 
	P.PAWNTICKET, P.LOANDATE, P.MATUDATE, P.EXPIRYDATE , P.AUCTIONDATE, 
    C.FIRSTNAME || ' ' || C.LASTNAME AS CLIENT,
	C.ADDR_STREET || ' ' || C.ADDR_CITY || ' ' || C.ADDR_CITY || ' ' || C.ADDR_ZIP as FULLADDRESS,
    CASE 
    	WHEN P.ITEMTYPE = 'JWL' AND (P.DESCRIPTION = Null OR P.DESCRIPTION = '') THEN 
        	CLASS.CATEGORY || ' ' || ROUND(P.GRAMS,2) || 'G ' || P.KARAT || 'K'
        ELSE P.DESCRIPTION
    END AS Description, 
    P.ORNUM, P.ORDATE, P.OLDTICKET, P.NETAMOUNT, P.RENEWDUE, P.REDEEMDUE, P.APPRAISAL, P.PRINCIPAL, 
    P.INTEREST, P.ADVINT, P.SERVICECHARGE,P.PENALTY, P.ITEMTYPE, CLASS.CATEGORY, P.GRAMS, P.KARAT,
    CASE P.STATUS
	    WHEN '0' THEN 'RENEWED'
        WHEN 'R' THEN 'RENEW'
        WHEN 'L' THEN 'NEW'
        WHEN 'V' THEN 'VOID'
        WHEN 'W' THEN 'WITHDRAW'
        WHEN 'X' THEN 'REDEEM'
        WHEN 'S' THEN 'SEGRE'
        ELSE 'N/A'
    END AS STATUS, P.PULLOUT , USR.USERNAME as APPRAISER
FROM TBLPAWN P
INNER JOIN TBLCLIENT C 
	ON C.CLIENTID = P.CLIENTID
LEFT JOIN TBLCLASS CLASS
	ON CLASS.CLASSID = P.CATID
LEFT JOIN TBL_USER_DEFAULT USR
    ON USR.USERID = P.APPRAISERID;



PawnList
CREATE VIEW PAWN_LIST(
  PAWNID,PAWNTICKET,LOANDATE,MATUDATE,EXPIRYDATE,AUCTIONDATE,CLIENTID,CLIENT,
  CONTACTNUMBER,FULLADDRESS,ITEMCLASS,ITEMCATEGORY,DESCRIPTION, OLDTICKET,ORNUM,ORDATE,PRINCIPAL,
DELAYINTEREST,ADVINT,SERVICECHARGE,NETAMOUNT,RENEWDUE,REDEEMDUE,APPRAISAL,PENALTY,
  STATUS,WITHDRAWDATE,APPRAISER,SENT_NOTICE)
AS
SELECT 
P.PAWNID, P.PAWNTICKET, P.LOANDATE, P.MATUDATE, P.EXPIRYDATE, P.AUCTIONDATE, 
C.CLIENTID, C.FIRSTNAME || ' ' || C.LASTNAME || ' ' || 
CASE WHEN C.SUFFIX is Null THEN '' ELSE C.SUFFIX END AS CLIENT, C.PHONE1 AS CONTACTNUMBER, 
C.ADDR_STREET || ' ' || C.ADDR_BRGY || ' ' || C.ADDR_CITY || ' ' || C.ADDR_PROVINCE || ' ' || C.ADDR_ZIP as FULLADDRESS, 
ITM.ITEMCLASS, CLASS.ITEMCATEGORY, P.DESCRIPTION, 
P.OLDTICKET, P.ORNUM, P.ORDATE, P.PRINCIPAL, P.DELAYINTEREST, P.ADVINT, P.SERVICECHARGE, 
P.NETAMOUNT, P.RENEWDUE, P.REDEEMDUE, P.APPRAISAL,P.PENALTY, 
P.STATUS, ITM.WITHDRAWDATE, USR.USERNAME AS APPRAISER, P.SENT_NOTICE 
FROM OPT P 
INNER JOIN TBLCLIENT C ON P.CLIENTID = C.CLIENTID 
INNER JOIN OPI ITM ON ITM.PAWNITEMID = P.PAWNITEMID 
INNER JOIN TBLITEM CLASS ON CLASS.ITEMID = ITM.ITEMID 
LEFT JOIN TBL_USER_DEFAULT USR ON USR.USERID = P.APPRAISERID;


